/* * TransportTableModel.java * * Created on 20 novembre 2002, 14:22 */package srcastra.astra.gui.components.combobox.liste;import srcastra.astra.sys.rmi.astrainterface;import srcastra.astra.sys.classetransfert.Loginusers_T;import java.util.ArrayList;import srcastra.astra.Astra;import java.rmi.RemoteException;import srcastra.astra.gui.sys.ErreurScreenLibrary;import srcastra.astra.gui.sys.formVerification.ListSelectorMask;import srcastra.astra.gui.sys.tableModel.AbstractAstraTableModel;import srcastra.astra.gui.sys.ErreurScreenLibrary;import srcastra.astra.gui.test.*;import srcastra.astra.sys.rmi.astrainterface;import srcastra.astra.sys.classetransfert.clients.Clients_T;import srcastra.astra.sys.classetransfert.Loginusers_T;import srcastra.astra.sys.classetransfert.utils.*;import java.util.ArrayList;import srcastra.astra.Astra;import java.rmi.RemoteException;import srcastra.astra.gui.sys.ErreurScreenLibrary;import srcastra.astra.gui.sys.formVerification.ListSelectorMask;import srcastra.astra.sys.Logger;import srcastra.astra.sys.rmi.Exception.ServeurSqlFailure;import srcastra.astra.sys.manipuleclient.ClientConstante;import srcastra.astra.gui.sys.tableModel.AbstractAstraTableModel;import srcastra.astra.gui.sys.ErreurScreenLibrary;import srcastra.astra.sys.classetransfert.dossier.ProduitAffichage;import javax.swing.*;import java.util.*;import java.awt.Component;import javax.swing.table.AbstractTableModel;import srcastra.astra.gui.sys.comparator.ListeSelectorComparaTor2;import srcastra.astra.sys.classetransfert.configuration.*;/** * @author Thomas */public class PeriodListeTableModel extends ListeTableModel implements ListeModelInterface {    /**     * Creates a new instance of TransportTableModel     */    ArrayList tmpVector;    public PeriodListeTableModel(astrainterface serveur, Loginusers_T login) {        super(serveur, login);        loadata();    }    public ArrayList loadata() {        if (m_vector == null) {            m_vector = new ArrayList();            try {                tmpVector = m_serveur.renvPeriodeRmiObject(m_login.getUrcleunik()).getList(m_login.getUrcleunik(), 0);            }            catch (RemoteException e) {                ErreurScreenLibrary.displayErreur(null, ErreurScreenLibrary.REMOTE_EXCEPTION, Astra.DEBUG, e, m_login);            }            catch (Exception e) {                ErreurScreenLibrary.displayErreur(null, ErreurScreenLibrary.EXCEPTION, Astra.DEBUG, e, m_login);            }            for (int i = 0; i < tmpVector.size(); i++) {                Periode_T periode = (Periode_T) tmpVector.get(i);                String libelle = java.util.ResourceBundle.getBundle("srcastra/astra/locale/compta", m_login.getLangage()).getString("ex_compta_debut") + " " + periode.getPede_de().toString2() + " " + java.util.ResourceBundle.getBundle("srcastra/astra/locale/compta", m_login.getLangage()).getString("ex_compta_a") + " " + periode.getPede_a().toString2();                Object[] tab = new Object[]{new Integer(periode.getPede_cleunik()), new Integer(periode.getPede_numper()), libelle, new Integer(i + 1), new Integer(periode.getPede_a().getYear())};                m_vector.add(tab);            }        }        return m_vector;    }    public srcastra.astra.gui.test.ColumnData[] getM_column() {        return this.m_columns;    }    public void setM_column(srcastra.astra.gui.test.ColumnData[] m_column) {        this.m_columns = m_column;    }    public Object getValueAt(int param, int param1) {        if (m_vector == null) return "";        if (param < 0 || param1 > getColumnCount())            return "";        Object[] tab = (Object[]) m_vector.get(param);        //String libelle=java.util.ResourceBundle.getBundle("srcastra/astra/locale/compta", m_login.getLangage()).getString("ex_compta_debut")+" "+periode.getPede_de().toString2()+" "+java.util.ResourceBundle.getBundle("srcastra/astra/locale/compta", m_login.getLangage()).getString("ex_compta_a")+" "+periode.getPede_a().toString2();        switch (param1) {            case 0:                return new srcastra.astra.gui.components.combobox.liste.RowColorListe(tab[1], 1);            case 1:                return new srcastra.astra.gui.components.combobox.liste.RowColorListe(tab[2], 1);        }        return "";    }    public String getColumnName(int column) {        return m_columns[column].c_title;    }    public int searchAWord(Object word, int column) {        int position = -1;        m_sortCol = column;        Object[] array;        Object[] array2 = new Object[getColumnCount() + 1];        for (int i = 0; i < array2.length; i++) {            array2[i] = word;        }        if (column == 0) {            loadata();            m_vector_by_key = (ArrayList) m_vector.clone();            Collections.sort(m_vector_by_key, new ListeSelectorComparaTor2(0, true));            array = m_vector_by_key.toArray();            position = Arrays.binarySearch(array, array2, this);        } else {            loadata();            if (m_vector == null)                return 0;            array = m_vector.toArray();            position = Arrays.binarySearch(array, array2, this);            int i = 0;            boolean trouve = false;            while (i < array.length && !trouve) {                Object[] o = (Object[]) array[i];                if (o[1].toString().equals(word.toString())) {                    srcastra.astra.sys.classetransfert.utils.Date d = srcastra.astra.sys.classetransfert.utils.CalculDate.getTodayDate();                    if (Integer.valueOf(o[4].toString()).intValue() == d.getYear()) {                        trouve = true;                        position = i;                    } else {                        position = i;                        i++;                    }                } else                    i++;            }        }        if (position < 0) return (position + 1) * -1;        return position;    }    ColumnData[] m_columns = new ColumnData[]{            new ColumnData(java.util.ResourceBundle.getBundle("srcastra/astra/locale/compta", m_login.getLangage()).getString("A_per"), 20, JLabel.LEFT),            new ColumnData(java.util.ResourceBundle.getBundle("srcastra/astra/locale/compta", m_login.getLangage()).getString("A_per"), 20, JLabel.LEFT)};}