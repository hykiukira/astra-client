/*

 * Pwd.java

 *

 * Created on 9 juillet 2003, 16:32

 */


package srcastra.astra.gui.modules.config.user;

import srcastra.astra.sys.classetransfert.configuration.*;

import srcastra.astra.gui.modules.*;

import srcastra.astra.gui.components.actions.actionToolBar.*;

import java.util.*;

import srcastra.astra.gui.components.*;

import srcastra.astra.gui.sys.formVerification.*;

import srcastra.astra.sys.classetransfert.*;

import srcastra.astra.gui.modules.config.*;

import srcastra.astra.sys.rmi.*;

import srcastra.astra.gui.sys.*;

import java.awt.event.*;


/**
 * @author Thomas
 */

public class Pwd extends javax.swing.JDialog {


    /**
     * Creates new form Pwd
     */

    User user;

    boolean modif;

    UserCOnfig panel;

    Loginusers_T user2;

    boolean cancel;

    public Pwd(java.awt.Frame parent, boolean modal, boolean modif, User user, UserCOnfig panel, Loginusers_T user2) {

        super(parent, modal);

        this.user = user;

        this.modif = modif;

        this.panel = panel;

        this.user2 = user2;

        initComponents();

        grp_TField_login.addKeyListener(this.key);

        jPasswordField1.addKeyListener(this.key);

        jPasswordField2.addKeyListener(this.key);

        jPasswordField3.addKeyListener(this.key);

        grp_Jlabel_message.setForeground(java.awt.Color.red);

        grp_TField_login.setDocument(new DefaultMask(1, 12, user2.getLangage(), DefaultMask.ALL_LETTRE_IN_UPPERCASE));

    }

    KeyAdapter key = new KeyAdapter() {

        public void keyPressed(KeyEvent evt) {

            grp_Jlabel_message.setText("");

        }

    };

    /**
     * This method is called from within the constructor to
     * <p/>
     * initialize the form.
     * <p/>
     * WARNING: Do NOT modify this code. The content of this method is
     * <p/>
     * always regenerated by the Form Editor.
     */

    private void initComponents() {//GEN-BEGIN:initComponents

        java.awt.GridBagConstraints gridBagConstraints;


        jPanel1 = new javax.swing.JPanel();

        jLabel1 = new javax.swing.JLabel();

        jLabel2 = new javax.swing.JLabel();

        jLabel3 = new javax.swing.JLabel();

        grp_TField_login = new srcastra.astra.gui.components.textFields.ATextField();

        jPasswordField1 = new javax.swing.JPasswordField();

        jPasswordField2 = new javax.swing.JPasswordField();

        grp_Jlabel_message = new javax.swing.JLabel();

        jLabel5 = new javax.swing.JLabel();

        jPasswordField3 = new javax.swing.JPasswordField();

        grp_Button_Accept = new javax.swing.JButton();

        grp_Button_Cancel = new javax.swing.JButton();


        addWindowListener(new java.awt.event.WindowAdapter() {

            public void windowClosing(java.awt.event.WindowEvent evt) {

                closeDialog(evt);

            }

        });


        jPanel1.setLayout(new java.awt.GridBagLayout());


        jLabel1.setFont(new java.awt.Font("Tahoma", 1, 10));

        jLabel1.setText("Login");

        jLabel1.setPreferredSize(new java.awt.Dimension(150, 13));

        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;

        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;

        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);

        jPanel1.add(jLabel1, gridBagConstraints);


        jLabel2.setFont(new java.awt.Font("Tahoma", 1, 10));

        jLabel2.setText("Old password");

        jLabel2.setPreferredSize(new java.awt.Dimension(150, 13));

        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.gridx = 0;

        gridBagConstraints.gridy = 1;

        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;

        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;

        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);

        jPanel1.add(jLabel2, gridBagConstraints);


        jLabel3.setFont(new java.awt.Font("Tahoma", 1, 10));

        jLabel3.setText("New password");

        jLabel3.setPreferredSize(new java.awt.Dimension(150, 13));

        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.gridx = 0;

        gridBagConstraints.gridy = 2;

        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;

        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;

        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);

        jPanel1.add(jLabel3, gridBagConstraints);


        grp_TField_login.setGrp_Comp_nextComponent(jPasswordField1);

        grp_TField_login.setPreferredSize(new java.awt.Dimension(150, 18));

        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;

        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;

        jPanel1.add(grp_TField_login, gridBagConstraints);


        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.gridx = 1;

        gridBagConstraints.gridy = 1;

        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;

        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;

        jPanel1.add(jPasswordField1, gridBagConstraints);


        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.gridx = 1;

        gridBagConstraints.gridy = 2;

        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;

        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;

        jPanel1.add(jPasswordField2, gridBagConstraints);


        grp_Jlabel_message.setFont(new java.awt.Font("Tahoma", 1, 10));

        grp_Jlabel_message.setPreferredSize(new java.awt.Dimension(38, 20));

        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.gridx = 0;

        gridBagConstraints.gridy = 4;

        gridBagConstraints.gridwidth = 2;

        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;

        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;

        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);

        jPanel1.add(grp_Jlabel_message, gridBagConstraints);


        jLabel5.setFont(new java.awt.Font("Tahoma", 1, 10));

        jLabel5.setText("Password confirmation");

        jLabel5.setMaximumSize(new java.awt.Dimension(41, 13));

        jLabel5.setPreferredSize(new java.awt.Dimension(150, 13));

        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.gridx = 0;

        gridBagConstraints.gridy = 3;

        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;

        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;

        gridBagConstraints.insets = new java.awt.Insets(0, 0, 14, 5);

        jPanel1.add(jLabel5, gridBagConstraints);


        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.gridx = 1;

        gridBagConstraints.gridy = 3;

        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;

        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;

        jPanel1.add(jPasswordField3, gridBagConstraints);


        grp_Button_Accept.setText("Accept");

        grp_Button_Accept.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {

                grp_Button_AcceptActionPerformed(evt);

            }

        });


        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.gridx = 0;

        gridBagConstraints.gridy = 5;

        jPanel1.add(grp_Button_Accept, gridBagConstraints);


        grp_Button_Cancel.setText("Cancel");

        grp_Button_Cancel.addActionListener(new java.awt.event.ActionListener() {

            public void actionPerformed(java.awt.event.ActionEvent evt) {

                grp_Button_CancelActionPerformed(evt);

            }

        });


        gridBagConstraints = new java.awt.GridBagConstraints();

        gridBagConstraints.gridx = 1;

        gridBagConstraints.gridy = 5;

        jPanel1.add(grp_Button_Cancel, gridBagConstraints);


        getContentPane().add(jPanel1, java.awt.BorderLayout.CENTER);


        pack();

        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();

        setSize(new java.awt.Dimension(400, 200));

        setLocation((screenSize.width - 400) / 2, (screenSize.height - 200) / 2);

    }//GEN-END:initComponents

    private void grp_Button_AcceptActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_grp_Button_AcceptActionPerformed

        if (grp_TField_login.getText().equals("")) {

            grp_Jlabel_message.setText("Login can not be null !");

            return;

        }

        String tmp1 = jPasswordField2.getText();

        String tmp2 = jPasswordField2.getText();

        System.out.println("verif" + tmp1 + " " + tmp2);

        if (!jPasswordField2.getText().equals(jPasswordField3.getText())) {

            grp_Jlabel_message.setText("Passawords are not the same !");

            return;

        }

        try {

            boolean testlogin = panel.getRmiInteface().checkLogin(user2.getUrcleunik(), grp_TField_login.getText());

            if (testlogin) {

                grp_Jlabel_message.setText("Login already exist !");

                return;

            }

            user.setUrlogin(grp_TField_login.getText());

            user.setPwd(jPasswordField2.getText());

            cancel = false;

            setVisible(false);

            dispose();

        } catch (srcastra.astra.sys.rmi.Exception.ServeurSqlFailure se) {

            ErreurScreenLibrary.displayErreur(this, ErreurScreenLibrary.SERVEUR_SQL_FAILURE, srcastra.astra.Astra.DEBUG, se);

        }

        catch (java.rmi.RemoteException re) {

            ErreurScreenLibrary.displayErreur(this, ErreurScreenLibrary.REMOTE_EXCEPTION, srcastra.astra.Astra.DEBUG, re);

        }


    }//GEN-LAST:event_grp_Button_AcceptActionPerformed

    private void grp_Button_CancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_grp_Button_CancelActionPerformed

        // Add your handling code here:

        setVisible(false);

        dispose();

        cancel = true;

    }//GEN-LAST:event_grp_Button_CancelActionPerformed

    /**
     * Closes the dialog
     */

    private void closeDialog(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_closeDialog

        setVisible(false);

        dispose();

    }//GEN-LAST:event_closeDialog

    /**
     * @param args the command line arguments
     */

    public static void main(String args[]) {

    }


    /**
     * Getter for property modif.
     *
     * @return Value of property modif.
     */

    public boolean isModif() {

        return modif;

    }


    /**
     * Setter for property modif.
     *
     * @param modif New value of property modif.
     */

    public void setModif(boolean modif) {

        this.modif = modif;

    }


    /**
     * Getter for property user.
     *
     * @return Value of property user.
     */

    public srcastra.astra.sys.classetransfert.configuration.User getUser() {

        return user;

    }


    /**
     * Setter for property user.
     *
     * @param user New value of property user.
     */

    public void setUser(srcastra.astra.sys.classetransfert.configuration.User user) {

        this.user = user;

    }


    /**
     * Getter for property cancel.
     *
     * @return Value of property cancel.
     */

    public boolean isCancel() {

        return cancel;

    }


    /**
     * Setter for property cancel.
     *
     * @param cancel New value of property cancel.
     */

    public void setCancel(boolean cancel) {

        this.cancel = cancel;

    }

    // Variables declaration - do not modify//GEN-BEGIN:variables

    private javax.swing.JPasswordField jPasswordField3;

    private javax.swing.JPasswordField jPasswordField2;

    private javax.swing.JPasswordField jPasswordField1;

    private javax.swing.JPanel jPanel1;

    private javax.swing.JButton grp_Button_Accept;

    private javax.swing.JButton grp_Button_Cancel;

    private javax.swing.JLabel grp_Jlabel_message;

    private javax.swing.JLabel jLabel5;

    private srcastra.astra.gui.components.textFields.ATextField grp_TField_login;

    private javax.swing.JLabel jLabel3;

    private javax.swing.JLabel jLabel2;

    private javax.swing.JLabel jLabel1;

    // End of variables declaration//GEN-END:variables


}

