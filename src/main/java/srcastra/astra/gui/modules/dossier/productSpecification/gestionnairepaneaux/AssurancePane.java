/* * AssurancePane.java * * Created on 6 octobre 2002, 20:57 */package srcastra.astra.gui.modules.dossier.productSpecification.gestionnairepaneaux;import srcastra.astra.gui.modules.mainScreenModule.DossierMainScreenModule;import srcastra.astra.gui.modules.dossier.DossierProduitPane;import srcastra.astra.gui.modules.InternScreenModule;import srcastra.astra.gui.components.actions.actionToolBar.*;import java.awt.event.*;import srcastra.astra.gui.components.fx.*;import srcastra.astra.gui.components.*;import srcastra.astra.gui.sys.formVerification.*;import srcastra.astra.sys.classetransfert.dossier.assurance.*;import srcastra.astra.gui.components.actions.*;import srcastra.astra.gui.event.ValidateField;import srcastra.astra.sys.classetransfert.dossier.*;import java.awt.*;import srcastra.astra.gui.sys.utils.*;import srcastra.astra.sys.compta.*;/** * @author Administrateur */public class AssurancePane extends javax.swing.JPanel implements InternScreenModule, ToolBarComposer, InterfacePanel {////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// CONSTRUCTOR////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    /**     * Creates new form AssurancePane     */    AbstractSousPanel m_parent;    private double montantAssurance;    private float percentage;    private float tax;    public AssurancePane(AbstractSousPanel parent2) {        m_parent = parent2;        this.parent = m_parent.getMainScreenModule();        this.parentProduit = parentProduit;        init();        m_parent.m_config.textarea = grp_TArea_Memo1;        displayReadMode();    }    public void requestOwnFocus() {    }////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// INITIALISATION////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    public void init() {        initComponents();        setBounds(0, 0, 708, 233);        /*   grp_Pan_supReduc = new SupReducPanel(parent, this, InterfaceProduit.AS);        grp_Pan_supReducEdition = new SupReducPanelEdition(parent, this, grp_Pan_supReduc, srcastra.astra.sys.classetransfert.dossier.InterfaceProduit.AS);        grp_SPane_pane2.add(grp_Pan_supReducEdition);        jPanel8.add(grp_Pan_supReduc);*/        componentToVerif = new AstraComponent[]{grp_TField_NPolice1, grp_TField_Pourcentage1, grp_TField_MontantAssurance1, grp_TField_ImpotTaxe1};        if (!m_parent.m_config.test) {            tb_interaction = new ToolBarInteraction(parent, this, componentToVerif);            tb_interaction.setValidateActionEnvironnement(ToolBarInteraction.ACT_ENV_WITH_SWITCH_PROD);            for (int i = 0; i < componentToVerif.length; i++) {                componentToVerif[i].addActionListener(tb_interaction.getValidateActionListener());            }        }        /*  fx_manager = new JPanelSelectionFxManager();        javax.swing.border.LineBorder lb = new javax.swing.border.LineBorder(new java.awt.Color(0,0,102), 5);        fx_assurance = new JPanelSelectionFx(parent, jPanel9, lb, this);        fx_supReduc = new JPanelSelectionFx(parent, grp_Pan_supReduc, lb, this);        fx_manager.addJPanelSelectionFx(fx_assurance);        fx_manager.addJPanelSelectionFx(fx_supReduc);         grp_Pan_supReduc.setFx_manager(fx_manager);*/        grp_TArea_Memo1.addFocusListener(new AssurancePane.ChangeBorderWhenFocused(grp_TArea_Memo1, new javax.swing.border.LineBorder(java.awt.Color.black)));        grp_TField_MontantAssurance1.addActionListener(calculListener);        grp_TField_Pourcentage1.addActionListener(calculListener);        grp_TField_ImpotTaxe1.addActionListener(m_parent.m_config.getValidate());        setDocument();    }    private void setDocument() {        grp_TField_NPolice1.setDocument(new DefaultMask(1, 25, parent.getCurrentUser().getLangage(), DefaultMask.ALL_LETTRE_IN_UPPERCASE));        grp_TField_Pourcentage1.setDocument(new DecimalMask(3, 2, parent.getCurrentUser().getLangage()));        grp_TField_MontantAssurance1.setDocument(new DecimalMask(5, 2, parent.getCurrentUser().getLangage()));        grp_TField_ImpotTaxe1.setDocument(new DecimalMask(5, 2, parent.getCurrentUser().getLangage()));    }    /*private void chargeFxSelection() {         //fx_manager.resetToDefault();                if (parentProduit.isM_Creation()) {            fx_manager.addJPanelSelectionFx(fx_assurance);            fx_manager.addJPanelSelectionFx(fx_supReduc);                  // grp_LPane_SegAndReduc.moveToFront(grp_Pan_Segments);        }        else {            fx_manager.addJPanelSelectionFx(fx_supReduc);                   fx_manager.addJPanelSelectionFx(fx_assurance);            //grp_LPane_SegAndReduc.moveToFront(grp_Pan_SupReducPanel);        }                }*/    /**     * This method is called from within the constructor to     * initialize the form.     * WARNING: Do NOT modify this code. The content of this method is     * always regenerated by the Form Editor.     */    private void initComponents() {//GEN-BEGIN:initComponents        java.awt.GridBagConstraints gridBagConstraints;        jPanel71 = new javax.swing.JPanel();        jPanel41 = new javax.swing.JPanel();        jLabel11 = new javax.swing.JLabel();        grp_TField_NPolice1 = new srcastra.astra.gui.components.textFields.ATextField();        jPanel11 = new javax.swing.JPanel();        jPanel31 = new javax.swing.JPanel();        jScrollPane11 = new javax.swing.JScrollPane();        grp_TArea_Memo1 = new javax.swing.JTextArea();        jPanel21 = new javax.swing.JPanel();        jPanel51 = new javax.swing.JPanel();        jPanel61 = new javax.swing.JPanel();        jLabel21 = new javax.swing.JLabel();        jLabel31 = new javax.swing.JLabel();        jLabel41 = new javax.swing.JLabel();        jLabel51 = new javax.swing.JLabel();        jLabel61 = new javax.swing.JLabel();        grp_Label_Fournisseur1 = new javax.swing.JLabel();        grp_Label_MontantDossier1 = new javax.swing.JLabel();        grp_TField_Pourcentage1 = new srcastra.astra.gui.components.textFields.ATextField();        grp_TField_MontantAssurance1 = new srcastra.astra.gui.components.textFields.ATextField();        grp_TField_ImpotTaxe1 = new srcastra.astra.gui.components.textFields.ATextField();        jLabel71 = new javax.swing.JLabel();        jLabel81 = new javax.swing.JLabel();        setLayout(new java.awt.GridLayout(1, 0));        setPreferredSize(new java.awt.Dimension(708, 233));        jPanel71.setLayout(new java.awt.BorderLayout());        jPanel71.setPreferredSize(new java.awt.Dimension(708, 233));        jPanel41.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT));        jLabel11.setFont(new java.awt.Font("Tahoma", 0, 10));        jLabel11.setText(java.util.ResourceBundle.getBundle("srcastra/astra/locale/ModuleDossier/productSpecification/AssurancePanel", parent.getCurrentUser().getLangage()).getString("grp_TField_NPolice"));        jPanel41.add(jLabel11);        grp_TField_NPolice1.setGrp_Comp_nextComponent(grp_TField_Pourcentage1);        grp_TField_NPolice1.setWarningIcon(new javax.swing.ImageIcon(getClass().getResource("/srcastra/astra/gui/img/aTextfield/warning.gif")));        grp_TField_NPolice1.setWorkingIcon(new javax.swing.ImageIcon(getClass().getResource("/srcastra/astra/gui/img/aTextfield/working.gif")));        jPanel41.add(grp_TField_NPolice1);        jPanel71.add(jPanel41, java.awt.BorderLayout.NORTH);        jPanel11.setLayout(new java.awt.BorderLayout());        jPanel11.setPreferredSize(new java.awt.Dimension(350, 150));        jPanel31.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT));        jPanel31.setPreferredSize(new java.awt.Dimension(410, 150));        jScrollPane11.setPreferredSize(new java.awt.Dimension(400, 150));        grp_TArea_Memo1.setFont(new java.awt.Font("Tahoma", 0, 10));        grp_TArea_Memo1.setDisabledTextColor(new java.awt.Color(0, 0, 0));        jScrollPane11.setViewportView(grp_TArea_Memo1);        jPanel31.add(jScrollPane11);        jPanel11.add(jPanel31, java.awt.BorderLayout.CENTER);        jPanel71.add(jPanel11, java.awt.BorderLayout.CENTER);        jPanel21.setPreferredSize(new java.awt.Dimension(230, 200));        jPanel51.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.LEFT));        jPanel51.setMinimumSize(new java.awt.Dimension(230, 200));        jPanel51.setPreferredSize(new java.awt.Dimension(230, 180));        jPanel61.setLayout(new java.awt.GridBagLayout());        jLabel21.setFont(new java.awt.Font("Tahoma", 0, 10));        jLabel21.setText(java.util.ResourceBundle.getBundle("srcastra/astra/locale/ModuleDossier/productSpecification/AssurancePanel", parent.getCurrentUser().getLangage()).getString("grp_Label_Fournisseur"));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 7);        jPanel61.add(jLabel21, gridBagConstraints);        jLabel31.setFont(new java.awt.Font("Tahoma", 0, 10));        jLabel31.setText(java.util.ResourceBundle.getBundle("srcastra/astra/locale/ModuleDossier/productSpecification/AssurancePanel", parent.getCurrentUser().getLangage()).getString("grp_Label_MontantDossier"));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 1;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 7);        jPanel61.add(jLabel31, gridBagConstraints);        jLabel41.setFont(new java.awt.Font("Tahoma", 0, 10));        jLabel41.setText(java.util.ResourceBundle.getBundle("srcastra/astra/locale/ModuleDossier/productSpecification/AssurancePanel", parent.getCurrentUser().getLangage()).getString("grp_TField_Pourcentage"));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 2;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 7);        jPanel61.add(jLabel41, gridBagConstraints);        jLabel51.setFont(new java.awt.Font("Tahoma", 0, 10));        jLabel51.setText(java.util.ResourceBundle.getBundle("srcastra/astra/locale/ModuleDossier/productSpecification/AssurancePanel", parent.getCurrentUser().getLangage()).getString("grp_TField_ImpotTaxe"));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 4;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 7);        jPanel61.add(jLabel51, gridBagConstraints);        jLabel61.setFont(new java.awt.Font("Tahoma", 0, 10));        jLabel61.setText(java.util.ResourceBundle.getBundle("srcastra/astra/locale/ModuleDossier/productSpecification/AssurancePanel", parent.getCurrentUser().getLangage()).getString("grp_TField_MontantAssurance"));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 3;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 3);        jPanel61.add(jLabel61, gridBagConstraints);        grp_Label_Fournisseur1.setFont(new java.awt.Font("Tahoma", 1, 10));        grp_Label_Fournisseur1.setForeground(new java.awt.Color(255, 0, 0));        grp_Label_Fournisseur1.setPreferredSize(new java.awt.Dimension(100, 18));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridwidth = 3;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 0);        jPanel61.add(grp_Label_Fournisseur1, gridBagConstraints);        grp_Label_MontantDossier1.setBackground(new java.awt.Color(204, 0, 0));        grp_Label_MontantDossier1.setFont(new java.awt.Font("Tahoma", 1, 10));        grp_Label_MontantDossier1.setForeground(new java.awt.Color(255, 255, 0));        grp_Label_MontantDossier1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);        grp_Label_MontantDossier1.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0)));        grp_Label_MontantDossier1.setPreferredSize(new java.awt.Dimension(70, 18));        grp_Label_MontantDossier1.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);        grp_Label_MontantDossier1.setOpaque(true);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 1;        gridBagConstraints.gridy = 1;        gridBagConstraints.gridwidth = 2;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 0);        jPanel61.add(grp_Label_MontantDossier1, gridBagConstraints);        grp_TField_Pourcentage1.setGrp_Comp_nextComponent(grp_TField_MontantAssurance1);        grp_TField_Pourcentage1.setHorizontalAlignment(javax.swing.JLabel.RIGHT);        grp_TField_Pourcentage1.setPreferredSize(new java.awt.Dimension(70, 18));        grp_TField_Pourcentage1.setWarningIcon(new javax.swing.ImageIcon(getClass().getResource("/srcastra/astra/gui/img/aTextfield/warning.gif")));        grp_TField_Pourcentage1.setWorkingIcon(new javax.swing.ImageIcon(getClass().getResource("/srcastra/astra/gui/img/aTextfield/working.gif")));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 1;        gridBagConstraints.gridy = 2;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 0);        jPanel61.add(grp_TField_Pourcentage1, gridBagConstraints);        grp_TField_MontantAssurance1.setGrp_Comp_nextComponent(grp_TField_ImpotTaxe1);        grp_TField_MontantAssurance1.setHorizontalAlignment(javax.swing.JLabel.RIGHT);        grp_TField_MontantAssurance1.setWarningIcon(new javax.swing.ImageIcon(getClass().getResource("/srcastra/astra/gui/img/aTextfield/warning.gif")));        grp_TField_MontantAssurance1.setWorkingIcon(new javax.swing.ImageIcon(getClass().getResource("/srcastra/astra/gui/img/aTextfield/working.gif")));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 1;        gridBagConstraints.gridy = 3;        gridBagConstraints.gridwidth = 3;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 0);        jPanel61.add(grp_TField_MontantAssurance1, gridBagConstraints);        grp_TField_ImpotTaxe1.setGrp_Comp_nextComponent(grp_TArea_Memo1);        grp_TField_ImpotTaxe1.setHorizontalAlignment(javax.swing.JLabel.RIGHT);        grp_TField_ImpotTaxe1.setWarningIcon(new javax.swing.ImageIcon(getClass().getResource("/srcastra/astra/gui/img/aTextfield/warning.gif")));        grp_TField_ImpotTaxe1.setWorkingIcon(new javax.swing.ImageIcon(getClass().getResource("/srcastra/astra/gui/img/aTextfield/working.gif")));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 1;        gridBagConstraints.gridy = 4;        gridBagConstraints.gridwidth = 3;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 0);        jPanel61.add(grp_TField_ImpotTaxe1, gridBagConstraints);        jLabel71.setFont(new java.awt.Font("Tahoma", 1, 10));        jLabel71.setText("%");        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 2;        gridBagConstraints.gridy = 2;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;        jPanel61.add(jLabel71, gridBagConstraints);        jLabel81.setFont(new java.awt.Font("Tahoma", 1, 10));        jLabel81.setText("\u20ac");        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 3;        gridBagConstraints.gridy = 1;        jPanel61.add(jLabel81, gridBagConstraints);        jPanel51.add(jPanel61);        jPanel21.add(jPanel51);        jPanel71.add(jPanel21, java.awt.BorderLayout.EAST);        add(jPanel71);    }//GEN-END:initComponents    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// => LISTENERS////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    /*   public void componentHidden(java.awt.event.ComponentEvent componentEvent) {        }        public void componentMoved(java.awt.event.ComponentEvent componentEvent) {        }        public void componentResized(java.awt.event.ComponentEvent componentEvent) {        }        public void componentShown(java.awt.event.ComponentEvent componentEvent) {            parent.setCurrentPanel(this);            switch (action) {                case ActionToolBar.ACT_READ :                    displayReadMode();                    break;                case ActionToolBar.ACT_INSERT :                    displayInsertMode();                    break;            }        }    */    private ActionListener calculListener = new ActionListener() {        public void actionPerformed(ActionEvent evt) {            if (evt.getSource().equals(grp_TField_Pourcentage1)) {                double total = parent.getDossier().getDrtotalprix();                if (total > 0d) {                    double pc = 0d;                    try {                        pc = Double.parseDouble(grp_TField_Pourcentage1.getText());                        if (percentage == pc) {                            return;                        } else if (!parent.getDossier().isNewreccord()) {                            parent.getDossier().setModifreccord(true);                            if (parent.getDossier().getDr_facture() == 1) {                                parent.getDossier().setComptaModify(true);                            }                        }                    } catch (NumberFormatException e) {                        return;                    }                    double rep = (total / 100) * pc;                    rep = MathRound.roundThisToDouble(rep);                    grp_TField_MontantAssurance1.setText("" + rep);                    if (rep > 0d) grp_TField_Pourcentage1.setGrp_Comp_nextComponent(grp_TField_ImpotTaxe1);                    else grp_TField_Pourcentage1.setGrp_Comp_nextComponent(grp_TField_MontantAssurance1);                    grp_TField_MontantAssurance1.clearIcon();                } else grp_TField_Pourcentage1.setGrp_Comp_nextComponent(grp_TField_MontantAssurance1);            } else if (evt.getSource().equals(grp_TField_MontantAssurance1)) {                double total = parent.getDossier().getDrtotalprix();                if (total > 0d) {                    double montant = 0d;                    try {                        montant = Double.parseDouble(grp_TField_MontantAssurance1.getText());                        if (montantAssurance == montant) {return;}                        else if (!parent.getDossier().isNewreccord()) {                            parent.getDossier().setModifreccord(true);                            if (parent.getDossier().getDr_facture() == 1) {                                parent.getDossier().setComptaModify(true);                            }                        }                    } catch (NumberFormatException e) {                        return;                    }                    double rep = montant / (total / 100);                    rep = MathRound.roundThisToDouble(rep);                    grp_TField_Pourcentage1.setText("" + rep);                    if (rep > 0d) grp_TField_Pourcentage1.setGrp_Comp_nextComponent(grp_TField_MontantAssurance1);                    else grp_TField_Pourcentage1.setGrp_Comp_nextComponent(grp_TField_ImpotTaxe1);                    grp_TField_Pourcentage1.clearIcon();                } else grp_TField_Pourcentage1.setGrp_Comp_nextComponent(grp_TField_MontantAssurance1);            }        }    };    /*  private ValidateField validateAndPrevious = new ValidateField() {        public void actionPerformed(ActionEvent evt) {             if (action == ActionToolBar.ACT_INSERT || action == ActionToolBar.ACT_MODIFY) {                   requestFocus();                   doPrevious();               }        }    };*/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// => METHODE APPARENTE AU BEANS////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    /*  public void displaySegmentPanel() {     requestFocus(); }   */    /*  public void displaySupReducEditionPanel(boolean show, int action) {        if (show){            grp_Pan_supReducEdition.setBounds(250, 0, 448, 216);            grp_SPane_pane2.moveToFront(grp_Pan_supReducEdition);            switch (action) {                case ActionToolBar.ACT_INSERT :                    grp_Pan_supReducEdition.displayInsertMode();                    break;                case ActionToolBar.ACT_READ :                    grp_Pan_supReducEdition.displayReadMode();                    break;                case ActionToolBar.ACT_MODIFY :                    grp_Pan_supReducEdition.displayUpdateMode();                    break;            }        }        else {            grp_SPane_pane2.moveToBack(grp_Pan_supReducEdition);        }    }            public SupReducPanelEdition getGrp_Pan_SupReducPanelEdition() {        return grp_Pan_supReducEdition;    }        public DossierProduitPane getGrp_Pane_produit() {        return parentProduit;    }        public void removeSegmentPanel() {    }*/    public void enableMemo(boolean enabled) {        java.awt.Color bg = (enabled) ? java.awt.Color.white : java.awt.Color.gray;        java.awt.Color fg = java.awt.Color.black;        grp_TArea_Memo1.setBackground(bg);        grp_TArea_Memo1.setForeground(fg);        grp_TArea_Memo1.setEditable(enabled);        grp_TArea_Memo1.setEnabled(enabled);    }////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// => FONCTIONS APPARENTES AU TRANSFERT DE DONNEE////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    /**     * Permet au parent de lancer le chargement des données au     * sein de liste (Ici : ListSelector)     */    public void chargeData() {        montantAssurance = parent.getAssurance().getAt_val_vente();        percentage = parent.getAssurance().getAce_pourcent();        tax = parent.getAssurance().getAce_taxe();        if (parent.getAssurance().getAce_numPolice() != null)            grp_TField_NPolice1.setText(parent.getAssurance().getAce_numPolice());        grp_Label_Fournisseur1.setText(parent.getAssurance().getFrnom());        grp_Label_MontantDossier1.setText("" + parent.getDossier().getDrtotalprix());        grp_TField_Pourcentage1.setText("" + parent.getAssurance().getAce_pourcent());        grp_TField_MontantAssurance1.setText("" + parent.getAssurance().getAt_val_vente());        grp_TField_ImpotTaxe1.setText("" + parent.getAssurance().getAce_taxe());    }    /**     * Demande d'une suppression ou d'une annulation physique au serveur     */    public void dbDelete() {    }    /**     * Demande d'une insertion au serveur     */    public void dbInsert() {        chargeAssuranceClassInsert();        parent.getAssurance().setLocalyModify(true);        parent.calculTotalUnProduit(parent.getAssurance());        displayReadMode();    }    private void chargeAssuranceClassInsert() {        if (!parent.getDossier().isNewreccord()) parent.getDossier().setModifreccord(true);        parent.getAssurance().setAt_cleunik(parent.getAssuranceCompteur());        parent.decrementeAssuranceCompteur();        parent.getAssurance().setIsnewreccord(true);        parent.getAssurance().setLongtime();        //  parent.getAssurance().setDatetimecrea(new srcastra.astra.sys.classetransfert.utils.Date());        // parent.getAssurance().getDatetimecrea().setLongTime();        chargeAssuranceClass();    }    private Assurance_T chargeAssuranceClass() {        parent.getAssurance().setAce_numPolice(grp_TField_NPolice1.getText());        parent.getAssurance().setAce_memo(grp_TArea_Memo1.getText());        try {            parent.getAssurance().setAce_pourcent(Float.parseFloat(grp_TField_Pourcentage1.getText()));        } catch (NumberFormatException e) {            parent.getAssurance().setAce_pourcent(0f);            System.out.println("Exception");        }        try {            parent.getAssurance().setAt_val_vente(Double.parseDouble(grp_TField_MontantAssurance1.getText()));        } catch (NumberFormatException e) {            parent.getAssurance().setAt_val_vente(0.0d);            System.out.println("Exception");        }        try {            parent.getAssurance().setValeur_tot(Double.parseDouble(grp_TField_MontantAssurance1.getText()));        } catch (NumberFormatException e) {            parent.getAssurance().setValeur_tot(0.0d);            System.out.println("Exception");        }        try {            parent.getAssurance().setAce_taxe(Float.parseFloat(grp_TField_ImpotTaxe1.getText()));        } catch (NumberFormatException e) {            parent.getAssurance().setAce_taxe(0f);        }        parent.getAssurance().calculMontantTotal();        parent.getAssurance().prepareAffichage();        return assurance;    }    /**     * Demande de sélection au serveur     */    public void dbSelect() {    }    /**     * Demande de sélection en vue d'une modification au serveur     */    public void dbSelectForUpdate() {    }    /**     * Demande d'une modification au serveur     */    public void dbUpdate() {        chargeAssuranceClassUpdate();        parent.getAssurance().setLocalyModify(true);        parent.calculTotalUnProduit(parent.getAssurance());        displayReadMode();    }    private void chargeAssuranceClassUpdate() {        if (!parent.getDossier().isNewreccord()) parent.getDossier().setModifreccord(true);        if (!parent.getAssurance().isIsnewreccord()) parent.getAssurance().setModify(true);        parent.getAssurance().calculMontantTotal();        chargeAssuranceClass();    }    public void validateProduct() {        System.out.println("\n\n\n¨******************ISNERECORD?:" + parent.getAssurance().isIsnewreccord());        System.out.println("\n\n\n¨******************ISATTACHED?:" + parent.getAssurance().isIsattached());        System.out.println("\n\n\n¨******************ISMODIFY?:" + parent.getAssurance().isModify());        //if(parent.getTicket().isIsnewreccord()|| parent.getTicket().isModify()){        System.out.println("\n\n[okokkokokoInsert]");        parent.getAssurance().setIsattached(true);        if (parent.getDossier().getPoBilletIntitule().equals(""))            parent.getDossier().setPoBilletIntitule(parent.getAssurance().getAce_numPolice());        parent.getDossier().addAssurance(parent.getAssurance());        parent.getAssurance().setLocalyModify(false);        parentProduit.showProductPanel(0, 0);        parent.chargeStatusPanel();        //  }        // else System.out.println("\n\n[okokkokokoRien]");    }////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// => METHODE APPARENTE A L' AFFICHAGE DES DONNEES////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    public void chargeDefaultValue() {        grp_Label_Fournisseur1.setText(parent.getAssurance().getFrnom());        grp_Label_MontantDossier1.setText("" + parent.getDossier().getDrtotalprix());        grp_TField_Pourcentage1.setText("0.00");        grp_TField_MontantAssurance1.setText("0.00");        grp_TField_ImpotTaxe1.setText("0.00");    }    /**     * Affichage en Mode disable     */    public void displayDisableMode() {    }    /**     * Affichage en mode Insertion     */    public void displayInsertMode() {        // chargeFxSelection();        action = ActionToolBar.ACT_INSERT;        for (int i = 0; i < componentToVerif.length; i++) {            componentToVerif[i].setText("");        }        chargeDefaultValue();        for (int i = 0; i < componentToVerif.length; i++) {            componentToVerif[i].setEnabled(true);            componentToVerif[i].setLastFocusedComponent(true);            componentToVerif[i].clearIcon();        }        enableMemo(true);        //  fx_manager.needReselect();        grp_TField_NPolice1.requestFocus();    }    /**     * Affichage en mode Lecture     */    public void displayReadMode() {        // chargeFxSelection();        //    grp_Pan_supReduc.setTableEnabled(false);        //   fx_manager.setActivated(true);        action = ActionToolBar.ACT_READ;        chargeData();        for (int i = 0; i < componentToVerif.length; i++) {            componentToVerif[i].setEnabled(false);            componentToVerif[i].setLastFocusedComponent(false);            componentToVerif[i].clearIcon();        }        enableMemo(false);        /*   parent.setCurrentActionEnabled(new int[] { ActionToolBar.DO_MODIFY,                                                   ActionToolBar.DO_PREVIOUS,                                                   ActionToolBar.DO_CANCEL,                                                   ActionToolBar.DO_SWITCH });                fx_manager.needReselect();        grp_Pan_supReduc.reloadInfo();        requestFocus();*/    }    /**     * Affichage en mode Modification     */    double oldValue;    public void displayUpdateMode() {        action = ActionToolBar.ACT_MODIFY;        for (int i = 0; i < componentToVerif.length; i++) {            componentToVerif[i].setEnabled(true);            componentToVerif[i].setLastFocusedComponent(true);            componentToVerif[i].clearIcon();        }        try {            this.oldValue = Double.parseDouble(grp_TField_MontantAssurance1.getText());        } catch (NumberFormatException nn) {            oldValue = 0;        }        enableMemo(true);        grp_TField_NPolice1.requestFocus();    }    /**     * Méthode pour l'update de tous les champs     */    public void updateAllFields() {    }    public void updateAllFields(Object donnee) {    }////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// => METHODE APPARENTE AUX APPELS DE LA TOOLBAR////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    /**     * Spécifie le composant qui implémente cette fonction comme     * le composant qui pilote l'actionToolBar     */    public void setThisAsToolBarComponent() {    }    public void doAccept() {    }    public void doCancel() {        parent.changeCursor(CursorChange.CHANGE_CURSOR_EVERYWHERE, new Cursor(Cursor.WAIT_CURSOR));        switch (action) {            case ActionToolBar.ACT_INSERT:                tb_interaction.enableValidateActionListener(false);                parentProduit.showProductPanel(0, 0);                break;            case ActionToolBar.ACT_MODIFY:                displayReadMode();                break;            case ActionToolBar.ACT_READ:                if (parent.getAssurance().isLocalyModify()) {                    int rep = parent.getMessageManager().showConfirmDialog(this, "produit_annul_texte", "produit_annul", parent.getCurrentUser());                    if (rep == 0) {                        if (tmpAssurance != null) {                            parent.setAssurance(tmpAssurance);                            parent.getDossier().addAssurance(parent.getAssurance());                        }                        parentProduit.showProductPanel(0, 0);                    }                } else parentProduit.showProductPanel(0, 0);                // parent.cancelModule();                // parent.getDossier().addTicket(parent.getTicket());                break;        }        parent.changeCursor(CursorChange.CHANGE_CURSOR_EVERYWHERE, new Cursor(Cursor.DEFAULT_CURSOR));    }    public void doClose() {    }    public void doCreate() {    }    public void doDelete() {    }    public void doHelp() {    }    public void doModify() {    }    public void doNext() {    }    public void doPrevious() {    }    public void doPrint() {    }    public void doSwitch() {    }    public int[] getDefaultActionToolBarMask() {        return new int[]{ActionToolBar.DO_MODIFY, ActionToolBar.DO_PREVIOUS, ActionToolBar.DO_CANCEL, ActionToolBar.DO_SWITCH};    }    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// => Champs de la classe////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    private DossierMainScreenModule parent;    private DossierProduitPane parentProduit;    private int action;    private SupReducPanel grp_Pan_supReduc;    private SupReducPanelEdition grp_Pan_supReducEdition;    private JPanelSelectionFxManager fx_manager;    private AstraComponent[] componentToVerif;    private Assurance_T assurance;    private Assurance_T tmpAssurance;    private ToolBarInteraction tb_interaction;    private JPanelSelectionFx fx_assurance;    private JPanelSelectionFx fx_supReduc;    ////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// STATIC VARIABLES////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// => Graphic Component////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    // Variables declaration - do not modify//GEN-BEGIN:variables    private javax.swing.JLabel grp_Label_Fournisseur1;    private javax.swing.JLabel grp_Label_MontantDossier1;    private javax.swing.JTextArea grp_TArea_Memo1;    private srcastra.astra.gui.components.textFields.ATextField grp_TField_ImpotTaxe1;    private srcastra.astra.gui.components.textFields.ATextField grp_TField_MontantAssurance1;    private srcastra.astra.gui.components.textFields.ATextField grp_TField_NPolice1;    private srcastra.astra.gui.components.textFields.ATextField grp_TField_Pourcentage1;    private javax.swing.JLabel jLabel11;    private javax.swing.JLabel jLabel21;    private javax.swing.JLabel jLabel31;    private javax.swing.JLabel jLabel41;    private javax.swing.JLabel jLabel51;    private javax.swing.JLabel jLabel61;    private javax.swing.JLabel jLabel71;    private javax.swing.JLabel jLabel81;    private javax.swing.JPanel jPanel11;    private javax.swing.JPanel jPanel21;    private javax.swing.JPanel jPanel31;    private javax.swing.JPanel jPanel41;    private javax.swing.JPanel jPanel51;    private javax.swing.JPanel jPanel61;    private javax.swing.JPanel jPanel71;    private javax.swing.JScrollPane jScrollPane11;    // End of variables declaration//GEN-END:variables////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// BEANS PROPERTIES GET/SET SUPPORT////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////    /**     * Permet à la classe qui implémente cette méthode de se     * référencer auprès d' ActionToolBar     *     * @return le n° de l'action     */    public int getAction() {        return action;    }    /**     * Sert à recevoir le titre de son parent     * pour un cadre éventuel     *     * @return le titre du panneau     */    public String getTitle() {        return java.util.ResourceBundle.getBundle("srcastra/astra/locale/ModuleDossier/DossierProduitPane", parent.getCurrentUser().getLangage()).getString("Titre_Pane_assurance");    }    /**     * Permet de préciser le type d'action qu'on est occupé de faire :     * 0 pour lecture     * 1 pour création     * 2 pour modification     *     * @param action type d'action     */    public void setAction(int action) {        this.action = action;    }    /**     * Permet de recevoir la clé unique d'un objet relatif     * au modules : création par partie ou modification     *     * @param frCleUnik la clé unique     */    public void setFrCleunik(int frCleUnik) {    }    /**     * Getter for property tmpAssurance.     *     * @return Value of property tmpAssurance.     */    public srcastra.astra.sys.classetransfert.dossier.assurance.Assurance_T getTmpAssurance() {        return tmpAssurance;    }    /**     * Setter for property tmpAssurance.     *     * @param tmpAssurance New value of property tmpAssurance.     */    public void setTmpAssurance(srcastra.astra.sys.classetransfert.dossier.assurance.Assurance_T tmpAssurance) {        this.tmpAssurance = tmpAssurance;    }    public void goUp() {    }    public java.awt.Component m_getGeneriqueTable() {        return null;    }    public int doAccept(boolean sw) {        return 1;    }    public int doCancel(boolean sw) {        displayReadMode();        return 1;    }    public int doCreate(boolean sw) {        displayInsertMode();        return 1;    }    public int doDelete(boolean sw) {        return 1;    }    public int doModify(boolean sw) {        displayUpdateMode();        return 1;    }    public int doPrevious(boolean sw) {        switch (action) {            case ActionToolBar.ACT_INSERT:                dbInsert();                break;            case ActionToolBar.ACT_READ:                break;            case ActionToolBar.ACT_MODIFY:                dbUpdate();                break;        }        return 1;    }    public Object getSupReduc2(int i) {        return null;    }    public java.awt.Component getTable() {        return null;    }    public void moveInTable(int direction) {    }    public void reloadTableModel() {    }    public void setSup_reduc(Object sup_reduc) {    }    /**     * Getter for property tb_interaction.     *     * @return Value of property tb_interaction.     */    public srcastra.astra.gui.components.actions.ToolBarInteraction getTb_interaction() {        return tb_interaction;    }    /**     * Setter for property tb_interaction.     *     * @param tb_interaction New value of property tb_interaction.     */    public void setTb_interaction(srcastra.astra.gui.components.actions.ToolBarInteraction tb_interaction) {        this.tb_interaction = tb_interaction;    }    public void doF10() {    }    public void addKeystroque() {    }    public void doF7() {    }    public class ChangeBorderWhenFocused implements java.awt.event.FocusListener {        private javax.swing.JComponent m_comp;        private javax.swing.border.Border m_defaultBorder;        private javax.swing.border.Border m_focusedBorder;        public ChangeBorderWhenFocused(javax.swing.JComponent comp, javax.swing.border.Border focusedBorder) {            this.m_comp = comp;            this.m_defaultBorder = comp.getBorder();            this.m_focusedBorder = focusedBorder;        }        public void focusGained(java.awt.event.FocusEvent focusEvent) {            m_comp.setBorder(m_focusedBorder);        }        public void focusLost(java.awt.event.FocusEvent focusEvent) {            m_comp.setBorder(m_defaultBorder);        }    }}