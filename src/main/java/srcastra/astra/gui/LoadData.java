/* * LoadData.java * * Created on 11 septembre 2002, 13:55 */package srcastra.astra.gui;import srcastra.astra.sys.rmi.astrainterface;import srcastra.astra.sys.classetransfert.Loginusers_T;import java.rmi.RemoteException;import srcastra.astra.gui.sys.ErreurScreenLibrary;import srcastra.astra.gui.components.tva.*;import srcastra.astra.gui.modules.dossier.productSpecification.gestionnairepaneaux.*;import srcastra.astra.gui.modules.*;/** * @author Thomas */public class LoadData extends javax.swing.JDialog {    /**     * Creates new form LoadData     */    public LoadData(java.awt.Frame parent, boolean modal, astrainterface serveur, Loginusers_T currentUser) {        super(parent, modal);        initComponents();        this.serveur = serveur;        this.currentUser = currentUser;        // chargedata();        // dispose();    }    public void chargedata()    {        this.listModel = new javax.swing.DefaultListModel();        listModel.addListDataListener(new javax.swing.event.ListDataListener() {            public void contentsChanged(javax.swing.event.ListDataEvent e) {                /*int lastIndex = grp_List_etatChargement.getMaxSelectionIndex() -1;               grp_List_etatChargement.setSelectedIndex(lastIndex);               grp_List_etatChargement.ensureIndexIsVisible(lastIndex);                */            }            public void intervalAdded(javax.swing.event.ListDataEvent e) {                int lastIndex = listModel.getSize() - 1;                // System.out.println("[LAST INDEX] => " + lastIndex);                // grp_List_etatChargement.setSelectedIndex(lastIndex);                grp_List_etatChargement.ensureIndexIsVisible(lastIndex);            }            public void intervalRemoved(javax.swing.event.ListDataEvent e) {                /*int lastIndex = grp_List_etatChargement.getMaxSelectionIndex() -1;grp_List_etatChargement.setSelectedIndex(lastIndex);grp_List_etatChargement.ensureIndexIsVisible(lastIndex);                */            }        });        this.grp_List_etatChargement.setModel(this.listModel);        grp_PBar_loadingBar.setMaximum(15);        try {            boolean sw = false;            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, serveur.COMBO_PAYS, serveur.COMBO_PAYS_CAS1, sw);            if (!sw)                updateAllFields("Please wait.. Loading...", 1);            else                //updateAllFields("Liste des pays OK", 1);                updateAllFields("", 5);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, serveur.COMBO_CODE_POST, serveur.COMBO_CODE_POST_CAS + currentUser.getUrlmcleunik(), sw);            //updateAllFields("Chargement des Codes postaux pour le cas 1 : terminer", 3);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, serveur.COMBO_DEVISE, serveur.COMBO_DEVISECAS + currentUser.getUrlmcleunik(), sw);            //updateAllFields("Chargement des Devises pour le cas 1 : terminer", 5);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, serveur.COMBO_TITREPERSONNES, serveur.COMBO_TITREPERSONNESCAS + currentUser.getUrlmcleunik(), sw);            //updateAllFields("Chargement des Titres des personnes pour le cas 1 : terminer", 7);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, serveur.COMBO_LANGUE, serveur.COMBO_LANGUECAS1, sw);            //updateAllFields("Chargement des Langues pour le cas 1 : terminer", 9);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, serveur.COMBO_DESTINATION, serveur.COMBO_DESTINATIONCAS1, sw);            //updateAllFields("Chargement des Destinations pour le cas 1 : terminer", 11);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, serveur.COMBO_COMPAGNIE, serveur.COMBO_COMPAGNIECAS1, sw);            //updateAllFields("Chargement des Compagnie pour le cas 1 : terminer", 13);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, serveur.COMBO_COMPTE, serveur.COMBO_COMPTECAS + currentUser.getUrlmcleunik(), sw);            //updateAllFields("Chargement des Comptes pour le cas 1 : terminer", 15);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, astrainterface.COMBO_TVA_TYPE, astrainterface.COMBO_TVA_TYPECAS1, true);            updateAllFields("", 10);            serveur.renvcombo('f', currentUser.getUrcleunik(), currentUser.getUrlmcleunik(), 'p', "", 1, astrainterface.COMBO_FOURNISSEURCAS1, true);            updateAllFields("", 15);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, astrainterface.COMBO_TRANSPORT, astrainterface.COMBO_TRANSPORTCAS + currentUser.getUrlmcleunik(), true);            updateAllFields("", 21);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, astrainterface.COMBO_LOGEMENT, astrainterface.COMBO_LOGEMENTCAS + currentUser.getUrlmcleunik(), true);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, astrainterface.COMBO_EMBARQDEBARQ, astrainterface.COMBO_EMBARQDEBARQCAS1, true);            serveur.renvSignalitiques(currentUser.getUrlmcleunik(), currentUser.getUrcleunik(), 1, astrainterface.COMBO_NATIONALITE, astrainterface.COMBO_NATIONALITE_CAS1, true);            serveur.workWithDecision(null, currentUser.getUrcleunik(), srcastra.astra.gui.components.actions.actionToolBar.ActionToolBar.ACT_READ, null, 0, 0, 01, srcastra.astra.sys.configuration.AbstractRequete.DECSRIPTIF_LOG);            serveur.workWithDecision(null, currentUser.getUrcleunik(), srcastra.astra.gui.components.actions.actionToolBar.ActionToolBar.ACT_READ, null, 0, 0, 01, srcastra.astra.sys.configuration.AbstractRequete.DIVERS);            serveur.workWithDecision(null, currentUser.getUrcleunik(), srcastra.astra.gui.components.actions.actionToolBar.ActionToolBar.ACT_READ, null, 0, 0, 01, srcastra.astra.sys.configuration.AbstractRequete.IMPRESSION);            serveur.workWithDecision(null, currentUser.getUrcleunik(), srcastra.astra.gui.components.actions.actionToolBar.ActionToolBar.ACT_READ, null, 0, 0, 01, srcastra.astra.sys.configuration.AbstractRequete.MEMO);            serveur.workWithDecision(null, currentUser.getUrcleunik(), srcastra.astra.gui.components.actions.actionToolBar.ActionToolBar.ACT_READ, null, 0, 0, 01, srcastra.astra.sys.configuration.AbstractRequete.SUP_RECUC);            serveur.workWithDecision(null, currentUser.getUrcleunik(), srcastra.astra.gui.components.actions.actionToolBar.ActionToolBar.ACT_READ, null, 0, 0, 01, srcastra.astra.sys.configuration.AbstractRequete.TVA_REGIME);            serveur.workWithDecision(null, currentUser.getUrcleunik(), srcastra.astra.gui.components.actions.actionToolBar.ActionToolBar.ACT_READ, null, 0, 0, 01, srcastra.astra.sys.configuration.AbstractRequete.TVA_TYPE);            serveur.renvParamCompta(currentUser.getUrcleunik());            Loginusers_T initUser = new Loginusers_T();            initUser.setUrcleunik(currentUser.getUrcleunik());            MainScreenModule parent = new substitutDossierModule(null, initUser);            LoadTvaFrame load = new LoadTvaFrame(0, parent);            load.loadTva(serveur, initUser);            //  serveur.renvcombo('f',currentUser.getUrcleunik(),currentUser.getUrlmcleunik(),'p',"", 2,astrainterface.COMBO_FOURNISSEURCAS2,true);            //updateAllFields("Chargement des Fournisseur cas 2", 21);        }        catch (srcastra.astra.sys.rmi.Exception.ServeurSqlFailure se) {            ErreurScreenLibrary.displayErreur(this, ErreurScreenLibrary.SERVEUR_SQL_FAILURE, srcastra.astra.Astra.DEBUG, se);            setVisible(false);            dispose();        }        catch (java.rmi.RemoteException re) {            ErreurScreenLibrary.displayErreur(this, ErreurScreenLibrary.REMOTE_EXCEPTION, srcastra.astra.Astra.DEBUG, re);            setVisible(false);            dispose();        }    }    private void updateAllFields(String str, int value) {        listModel.addElement(str);        grp_PBar_loadingBar.setValue(value);        try {            Thread.currentThread().sleep(5);        }        catch (InterruptedException evt) {        }    }    /**     * This method is called from within the constructor to     * <p/>     * <p/>     * initialize the form.     * <p/>     * <p/>     * WARNING: Do NOT modify this code. The content of this method is     * <p/>     * <p/>     * always regenerated by the Form Editor.     */    private void initComponents() {//GEN-BEGIN:initComponents        java.awt.GridBagConstraints gridBagConstraints;        jPanel1 = new javax.swing.JPanel();        jPanel2 = new javax.swing.JPanel();        grp_PBar_loadingBar = new javax.swing.JProgressBar();        jScrollPane1 = new javax.swing.JScrollPane();        grp_List_etatChargement = new javax.swing.JList();        jLabel1 = new javax.swing.JLabel();        jLabel2 = new javax.swing.JLabel();        jTextArea1 = new javax.swing.JTextArea();        addWindowListener(new java.awt.event.WindowAdapter() {            public void windowClosing(java.awt.event.WindowEvent evt) {                closeDialog(evt);            }        });        jPanel1.setLayout(new java.awt.GridLayout(1, 0));        jPanel2.setLayout(new java.awt.GridBagLayout());        jPanel2.setPreferredSize(new java.awt.Dimension(310, 230));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 3;        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;        gridBagConstraints.insets = new java.awt.Insets(19, 0, 0, 0);        jPanel2.add(grp_PBar_loadingBar, gridBagConstraints);        jScrollPane1.setPreferredSize(new java.awt.Dimension(350, 100));        jScrollPane1.setViewportView(grp_List_etatChargement);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 2;        jPanel2.add(jScrollPane1, gridBagConstraints);        jLabel1.setFont(new java.awt.Font("MS Sans Serif", 1, 14));        jLabel1.setText(" ASTRA - Travel Back-Office Systems -");        jPanel2.add(jLabel1, new java.awt.GridBagConstraints());        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 4;        jPanel2.add(jLabel2, gridBagConstraints);        jPanel2.add(jTextArea1, new java.awt.GridBagConstraints());        jPanel1.add(jPanel2);        getContentPane().add(jPanel1, java.awt.BorderLayout.CENTER);        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();        setBounds((screenSize.width - 386) / 2, (screenSize.height - 250) / 2, 386, 250);    }//GEN-END:initComponents    /**     * Closes the dialog     */    private void closeDialog(java.awt.event.WindowEvent evt) {//GEN-FIRST:event_closeDialog        setVisible(false);        dispose();    }//GEN-LAST:event_closeDialog    /**     * @param args the command line arguments     */    // Variables declaration - do not modify//GEN-BEGIN:variables    private javax.swing.JList grp_List_etatChargement;    private javax.swing.JProgressBar grp_PBar_loadingBar;    private javax.swing.JLabel jLabel1;    private javax.swing.JLabel jLabel2;    private javax.swing.JPanel jPanel1;    private javax.swing.JPanel jPanel2;    private javax.swing.JScrollPane jScrollPane1;    private javax.swing.JTextArea jTextArea1;    // End of variables declaration//GEN-END:variables    private astrainterface serveur;    private Loginusers_T currentUser;    private javax.swing.DefaultListModel listModel;}